<div class="row col-md-11">
    <div class="row">
        <h4><b>Sản phẩm yêu thích ({{favoriteProducts.length}})</b></h4>
        <br> <br>
        <div class="mb-3" style="display: flex; justify-content: right;">
            <input type="text" class="form-control" name="" id="search-F" aria-describedby="helpId"
                style="border-radius: 20px; width: 50%;" ng-model="productNameF" ng-keyup="findProductF(0)"
                placeholder="Nhập sản phẩm cần tìm...">
            <span class="microphone" style="display: flex;
                justify-content: center;
                align-items: center; margin-left: 1rem;">
                <i class="fas fa-microphone"></i>
                <span class="recording-icon"></span>
            </span>

        </div>
        <br> <br>
        <div class="row">
            <div ng-class="{'col-lg-6': checkMenuLeft, 'col-lg-4': !checkMenuLeft}" class="col-sm-12"
                style="z-index: 10; margin-bottom: 3rem; border-radius: 5px;" ng-repeat="product in favoriteProducts">
                <div class="row frameProduct ">
                    <div class="col-md-6" style="display: flex;max-height: 100%;">

                        <a href="#!productdetails/{{product.productId}}" style="height: 100%; width: 100%;"><img
                                class="imghover" width="100%"
                                style="height: 100%; object-fit: cover; border-radius: 5px;"
                                ng-src="{{product.media[0].mediaUrl}}"></a>
                    </div>
                    <div class="col-md-6 frame" style="cursor: pointer;">
                        <div class="product__info">
                            <div class="user-profile ">
                                <a href="#!/profile/{{product.user.userId}}"><img ng-src="{{product.user.avatar}}"
                                        style="border-radius: 100%;" alt=""></a>
                                <div>
                                    <span
                                        style="font-weight: 600 !important; font-size: 1rem !important; margin: 0; color: #2A3547"
                                        class="ng-binding">{{product.user.username}}</span> &nbsp;&nbsp;
                                    <span><small style="font-size: 12px; color: #65676b" class="ng-binding">
                                            {{getFormattedTimeAgo(product.datePost)}}
                                        </small></span>
                                </div>
                            </div>
                            <hr>
                            <div class="title">
                                <b
                                    style="font-size: 1.2rem; white-space: nowrap;
                        text-overflow: ellipsis;display: block; width: 100%; overflow: hidden;">{{product.productName}}</b>
                            </div>
                            <div class="description">
                                <h3>Đánh giá <small>({{ calculateAverageRating(product.ratings) }})</small>

                                </h3>
                                <span>
                                    <span ng-if="calculateAverageRating(product.ratings)==0">
                                        <i ng-repeat="n in [].constructor(5) track by $index" class="fa-solid fa-star"
                                            style="color: #c0c0c0;"></i>
                                    </span>
                                    <span ng-if="calculateAverageRating(product.ratings)==1">
                                        <i ng-repeat="n in [].constructor(4) track by $index" class="fa-solid fa-star"
                                            style="color: #ffc107;"></i>
                                        <i ng-repeat="n in [].constructor(1) track by $index" class="fa-solid fa-star"
                                            style="color: #c0c0c0;"></i>

                                    </span>
                                    <span ng-if="calculateAverageRating(product.ratings)==2">
                                        <i ng-repeat="n in [].constructor(2) track by $index" class="fa-solid fa-star"
                                            style="color: #ffc107;"></i>
                                        <i ng-repeat="n in [].constructor(3) track by $index" class="fa-solid fa-star"
                                            style="color: #c0c0c0;"></i>
                                    </span>
                                    <span ng-if="calculateAverageRating(product.ratings)==3">
                                        <i ng-repeat="n in [].constructor(3) track by $index" class="fa-solid fa-star"
                                            style="color: #ffc107;"></i>
                                        <i ng-repeat="n in [].constructor(2) track by $index" class="fa-solid fa-star"
                                            style="color: #c0c0c0;"></i>
                                    </span>
                                    <span ng-if="calculateAverageRating(product.ratings)==4">
                                        <i ng-repeat="n in [].constructor(4) track by $index" class="fa-solid fa-star"
                                            style="color: #ffc107;"></i>
                                        <i ng-repeat="n in [].constructor(1) track by $index" class="fa-solid fa-star"
                                            style="color: #c0c0c0;"></i>
                                    </span>
                                    <span ng-if="calculateAverageRating(product.ratings)==5">
                                        <i ng-repeat="n in [].constructor(5) track by $index" class="fa-solid fa-star"
                                            style="color: #ffc107;"></i>
                                    </span>

                                    <!-- --------------------------------------------------------- -->

                                    <span
                                        ng-if="calculateAverageRating(product.ratings) > 0 && calculateAverageRating(product.ratings) < 1">
                                        <i class="fas fa-star-half-alt" style="color: #ffc107;"></i>
                                        <i ng-repeat="n in [].constructor(4) track by $index" class="fa-solid fa-star"
                                            style="color: #c0c0c0;"></i>
                                    </span>

                                    <span
                                        ng-if="calculateAverageRating(product.ratings) > 1 && calculateAverageRating(product.ratings) < 2">
                                        <i ng-repeat="n in [].constructor(1) track by $index" class="fa-solid fa-star"
                                            style="color: #ffc107;"></i>
                                        <i class="fas fa-star-half-alt" style="color: #ffc107;"></i>
                                        <i ng-repeat="n in [].constructor(3) track by $index" class="fa-solid fa-star"
                                            style="color: #c0c0c0;"></i>
                                    </span>
                                    <span
                                        ng-if="calculateAverageRating(product.ratings) > 2 && calculateAverageRating(product.ratings) < 3">
                                        <i ng-repeat="n in [].constructor(2) track by $index" class="fa-solid fa-star"
                                            style="color: #ffc107;"></i>
                                        <i class="fas fa-star-half-alt" style="color: #ffc107;"></i>
                                        <i ng-repeat="n in [].constructor(2) track by $index" class="fa-solid fa-star"
                                            style="color: #c0c0c0;"></i>
                                    </span>
                                    <span
                                        ng-if="calculateAverageRating(product.ratings) > 3 && calculateAverageRating(product.ratings) < 4">
                                        <i ng-repeat="n in [].constructor(3) track by $index" class="fa-solid fa-star"
                                            style="color: #ffc107;"></i>
                                        <i class="fas fa-star-half-alt" style="color: #ffc107;"></i>
                                        <i ng-repeat="n in [].constructor(1) track by $index" class="fa-solid fa-star"
                                            style="color: #c0c0c0;"></i>
                                    </span>
                                    <span
                                        ng-if="calculateAverageRating(product.ratings) > 4 && calculateAverageRating(product.ratings) < 5">
                                        <i ng-repeat="n in [].constructor(4) track by $index" class="fa-solid fa-star"
                                            style="color: #ffc107;"></i>
                                        <i class="fas fa-star-half-alt" style="color: #ffc107;"></i>
                                    </span>
                                </span>
                            </div>
                            <div class="note">
                                <span class="text-muted"><svg class="svg-inline--fa fa-shopping-basket fa-sm mx-1"
                                        aria-hidden="true" focusable="false" data-prefix="fas"
                                        data-icon="shopping-basket" role="img" xmlns="http://www.w3.org/2000/svg"
                                        viewBox="0 0 576 512" data-fa-i2svg="">
                                        <path fill="currentColor"
                                            d="M253.3 35.1c6.1-11.8 1.5-26.3-10.2-32.4s-26.3-1.5-32.4 10.2L117.6 192H32c-17.7 0-32 14.3-32 32s14.3 32 32 32L83.9 463.5C91 492 116.6 512 146 512H430c29.4 0 55-20 62.1-48.5L544 256c17.7 0 32-14.3 32-32s-14.3-32-32-32H458.4L365.3 12.9C359.2 1.2 344.7-3.4 332.9 2.7s-16.3 20.6-10.2 32.4L404.3 192H171.7L253.3 35.1zM192 304v96c0 8.8-7.2 16-16 16s-16-7.2-16-16V304c0-8.8 7.2-16 16-16s16 7.2 16 16zm96-16c8.8 0 16 7.2 16 16v96c0 8.8-7.2 16-16 16s-16-7.2-16-16V304c0-8.8 7.2-16 16-16zm128 16v96c0 8.8-7.2 16-16 16s-16-7.2-16-16V304c0-8.8 7.2-16 16-16s16 7.2 16 16z">
                                        </path>
                                    </svg><!-- <i class="fas fa-shopping-basket fa-sm mx-1"></i> -->{{product.ratings.length}}
                                    lượt đánh giá</span>
                                <span class="text-success ms-2">{{product.soldQuantity}} đã bán</span>
                            </div>

                            <div class="price animate__animated animate__fadeInUp">
                                <small ng-show="!product.promotion==0"><span
                                        style="text-decoration: line-through; color: gray;">{{product.originalPrice
                                        | currencyFormat}}
                                    </span> &nbsp; |&nbsp;</small>
                                <span> {{getSalePrice(product.originalPrice, product.promotion) |
                                    currencyFormat}}</span>
                            </div>
                            <button ng-click="getProduct(product.productId)" data-bs-toggle="modal"
                                data-bs-target="#modalId" class="buy--btn animate__animated animate__fadeInDown"
                                style="margin-top: 0.5rem;">Thêm vào
                                giỏ hàng</button>
                        </div>

                    </div>
                </div>

            </div>

        </div>
    </div>
    <center>
        <nav aria-label="Page navigation">
            <ul class="pagination">
                <li class="page-item" ng-click="Previous()" style="cursor: pointer;">
                    <a class="page-link" style="color: #313131;" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </a>
                </li>

                <li class="page-item" aria-current="page"><a style="font-weight: 600; color: #313131 !important; "
                        class="page-link">{{currentPage+1}} /
                        {{totalPagesF}}</a>
                </li>
                <li class="page-item" ng-click="Next()" style="cursor: pointer;">
                    <a class="page-link" style="color: #313131;" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
            </ul>
        </nav>
    </center>
    <!-- Modal -->
    <div class="modal fade" id="modalId" tabindex="-1" role="dialog" aria-labelledby="modalTitleId" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <center>
                        <h5 class="modal-title" id="modalTitleId"><b>Mua ngay, tiết kiệm ngay!</b></h5>
                    </center>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="container-fluid" style="line-height: 35px;">
                        <img ng-src="{{product.media[0].mediaUrl}}" style="border-radius: 10px;" alt="">
                        <b>{{product.productName}}</b>
                        <hr>
                        <b> Chọn màu:</b>
                        <div style="display: flex;" class="m-1">
                            <button ng-repeat="color in product.productColors" ng-click="getTotal(color.color.colorId)"
                                ng-class="{'dislike--btn': color.quantity > 0, 'btn-disable': color.quantity === 0}"
                                style="display: block; margin-right: 0.2rem; padding: 0.2rem;">{{color.color.colorName}}</button>
                        </div>
                        <span ng-show="total>0"><b>Số lượng còn lại:</b> {{total}}</span>
                        <span ng-show="total===0"><b>Số lượng còn lại:</b> Hết hàng</span>
                        <div class="input-group mb-3" style="width: 170px;">
                            <button ng-click="reduceQuantity()" class="btn btn-white border border-secondary px-3"
                                type="button" id="button-addon1" data-mdb-ripple-color="dark">
                                <i class="fas fa-minus"></i>
                            </button>
                            <input type="text" class="form-control text-center border border-secondary"
                                value="{{quantity}}" aria-label="Example text with button addon"
                                aria-describedby="button-addon1" />
                            <button ng-click="increaseQuantity()" class="btn btn-white border border-secondary px-3"
                                type="button" id="button-addon2" data-mdb-ripple-color="dark">
                                <i class="fas fa-plus"></i>
                            </button>

                        </div>
                        <button ng-click="addShoppingCart(product.productId)" data-bs-toggle="modal"
                            data-bs-target="#modalId" class="buy--btn animate__animated animate__fadeInDown"
                            style="margin-top: 1.5rem; display: block;width:100% ;">Thêm vào
                            giỏ hàng</button>
                    </div>
                </div>
                <!-- <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save</button>
            </div> -->
            </div>
        </div>
    </div>

    <script>
        var modalId = document.getElementById('modalId');

        modalId.addEventListener('show.bs.modal', function (event) {
            // Button that triggered the modal
            let button = event.relatedTarget;
            // Extract info from data-bs-* attributes
            let recipient = button.getAttribute('data-bs-whatever');

            // Use above variables to manipulate the DOM
        });
    </script>
</div>